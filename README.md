# files-remover

Утилита на Go для массового удаления файлов по шаблону имени в указанной директории.

Полезно, когда нужно почистить временные файлы, кэшей, бэкапов вида:
- `backup-2025-01-01.zip`
- `session_12345.tmp`
- `debug-2025.log`

## Возможности

- Поиск по точному имени или по шаблону (через разделитель в имени)
- Исключение произвольных поддиректорий (например, `node_modules`, `.git`)
- Демо-режим (`-m true`) — показывает, что будет удалено, ничего не трогая
- Человекочитаемый отчёт: сколько файлов, сколько места освободится (в KB/MB/GB)
- Безопасное удаление: ошибки `file not exists` игнорируются (TOCTOU protection)

## Установка

```bash
go install github.com/figurecode/files-remover@latest
```

Или собрать из исходников:

```bash
git clone https://github.com/figurecode/files-remover.git
cd files-remover
go build -o files-remover
```

## Использование

### Основные флаги

```bash
./files-remover -d <директория> [флаги] <шаблон1> [шаблон2...]
```

| Флаг | Обязательный? | Описание                                                                                 | По умолчанию        |
|:-----|:-------------:|------------------------------------------------------------------------------------------|---------------------|
| `-d` | Да*           | Путь к директории для поиска (*обязателен, если не запущено из нужной папки)             | текущая директория  |
| `-e` | Нет           | Исключаемые поддиректории (через запятую)                                                | —                   |
| `-m` | Нет           | `true` — демо-режим, `false` — реальное удаление                                         | `true`              |
| `-s` | Нет           | Разделитель для разбивки имени файла по частям                                           | `-`                 |

### Примеры

1. Показать, что будет удалено (демо-режим по умолчанию):

```bash
./files-remover -d /var/log app-debug.log backup-old.zip
```

2. Реально удалить все файлы с именем содержащим `temp-2025`:

```bash
./files-remover -d /tmp -m false temp-2025
```

3. Удалить все `.log` файлы старше определённой даты, исключив системные папки:

```bash
./files-remover -d /var/log -e /var/log/journal,.snapshots -m false access-2024.log error-2024.log
```

4. Удалить всё, что содержит `-cache-` в имени:

```bash
# Разделитель по умолчанию "-", поэтому работает
./files-remover -d ~/Library/Caches -m false cache
```

Если нужно использовать другой разделитель (например, `_`):

```bash
./files-remover -d /data -s _ -m false session
```

## Вывод в демо-режиме (пример)

```text
127 files will be deleted in total
3.4 GB will be freed up

Files to be deleted:
---------------------------------
PATH: /tmp/backup-full-2025-01-01.tar.gz
---------------------------------
PATH: /tmp/session_8f3d9a21.tmp
---------------------------------
PATH: /var/log/nginx/access-2024-12-01.log

END
```

## Безопасность

- По умолчанию работает в демо-режиме
- Всегда запускайте сначала без `-m false`
- Ошибки вида "файл уже удалён" игнорируются — утилита не падает из-за гонки

## Лицензия

MIT
